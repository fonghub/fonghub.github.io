---
layout:         page
title:          "Telegram Bot"
date:           2021-04-07 04:00:00 +0400
width:          700
author:         zaofengchen
catalog:        true 
permalink:      /:year/:month/:day/:title
keywords:       "Telegram Bot Group 飞机 机器人 群组"
tags:
    - blog
categories:     ['Telegram']
---

<!-- 渲染公式 -->
<script src="{{ site.url }}/static/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
        }
    });
</script>
<!-- 渲染公式 -->


#### 创建 Bot
查找官方账号 BotFather ，带有头像，并且账号名右边带后蓝色标志的就是。

点击 /start 指令后，显示有常用的指令和使用说明。
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqbjyahzj30u00vy0y6.jpg" width="{{ page.width}}" align="bottom" />
<center>BotFather</center>

1. 点击 /newbot 指令，开始创建 Bot
2. 首先输入 Bot 的名字（不会做唯一性检测）
3. 接着输入 Bot 的账户名（做唯一性检测），账户名必须以 bot 作为后缀
4. 最后会返回 Bot 的token，token可以看作是 Bot 的唯一ID，不可泄漏
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqblzj00j30u00vyn3y.jpg" width="{{ page.width}}" align="bottom" />
<center>创建Bot</center>


#### Bot 发消息到 User

查找刚刚创建的Bot，账号 testRebot_Bot ,点击 /start 指令。 
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqdetna7j30u00vydh6.jpg" width="{{ page.width}}" align="bottom" />
<center>testRebot_Bot</center>

Bot 发消息到 User ，使用 API ：
```
https://api.telegram.org/bot<token>/sendMessage?chat_id=<user_id>&text=<message>
```
尖括号里的三个参数分别是 Bot 的token，User 的 id 和发送的消息。

查找官方账号 userinfobot ，点击 /start 指令，就会返回 User 的信息，其中就包括了 User 的 id。
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqdg4b5dj30u00vydhg.jpg" width="{{ page.width}}" align="bottom" />
<center>石碑</center>

通过浏览器访问接口：
```
https://api.telegram.org/bot1715369074:AAHGwoVNoWDAT8YMmuwARH4LMIJO5oGduJg/sendMessage?chat_id=<user_id>&text=Hello World!
```
可得到成功的返回结果。通过 Telegram 可知 ，确实收到了 Bot 发来的测试消息。
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqfehhf0j30u00vy0ug.jpg" width="{{ page.width}}" align="bottom" />
<center>石碑</center>



#### Bot 发消息到 Group

与发送消息到 User 的 API 一样，唯一的区别是参数 chat_id 要换成群组id。

首先把 Bot 拉到一个群组里面，发送一条消息，激活群组。

<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqg4f0r6j30u00yv0u6.jpg" width="{{ page.width}}" align="bottom" />
<center>群组</center>

通过API：
```
https://api.telegram.org/bot<token>/getUpdates
```
可以查看 Bot 所在群组的群组id。

通过浏览器访问接口：
```
https://api.telegram.org/bot1715369074:AAHGwoVNoWDAT8YMmuwARH4LMIJO5oGduJg/getUpdates
```
可得群组id为：-564051528。
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqg6mrpmj30v20e2gmu.jpg" width="{{ page.width}}" align="bottom" />
<center>群组id</center>

通过浏览器访问接口：
```
https://api.telegram.org/bot1715369074:AAHGwoVNoWDAT8YMmuwARH4LMIJO5oGduJg/sendMessage?chat_id=-564051528&text=Hello Group!
```

可得到成功的返回结果。通过 Telegram 可知 ，群组收到了 Bot 发来的测试消息。

<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqgu9ftij30u00yvdhh.jpg" width="{{ page.width}}" align="bottom" />
<center>群组</center>



#### 删除 Bot
通过 /mybots 指令查看我的 Bot，先是一个或者多个。

点击 delete Bot 指令，经过几次重复确认后，可以删除没用的 Bot。
<img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gpaqhpon7pj30vm0j20vr.jpg" width="{{ page.width}}" align="bottom" />
<center>删除Bot</center>
