---
layout:         page
title:          "使用JavaScript格式化数组字符串"
date:           2021-06-29 11:00:00 +0400
width:          700
author:         zaofengchen
catalog:        true 
permalink:      /:year/:month/:day/:title
keywords:       "JavaScript 格式化 数组 字符串 "
tags:
    - blog
categories:     ['JavaScript']
---

<!-- 渲染公式 -->
<script src="{{ site.url }}/static/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
        }
    });
</script>
<!-- 渲染公式 -->

#### 格式化规则

1.  `[` 后面跟 `[` ，换行，增加缩进
2.  `,` 后面跟 `[` ，换行，增加缩进
3.  `]` 后面跟 `,` ，换行，缩进
4.  `]` 后面跟 `]` ，换行，减少缩进

#### 关于换行
1. HTML页面显示，使用 `<br>` 换行
2. 输入框显示，使用 `\n` 换行

#### 格式化函数

```html
<html>
    <head>
        <title>json</title>
    </head>
    <body>
        <script>
            var formatArrString = function(conf) 
            {
                let html = "";
                let tmp = "";       // 临时存储字符串
                let level = 0;      // 缩进行数          
                let num = 4;        // 缩进空格数
                for(let i=0;i<conf.length;i++)
                {
                    tmp += conf.charAt(i);
                    if(conf.charAt(i) == '[' && conf.charAt(i+1) == '[')
                    {
                        html += tmp;
                        html += "<br>";
                        level += num;
                        tmp = "";
                        for(let j=0;j<level;j++)
                            html += "\xa0"
                    }

                    if(conf.charAt(i) == ',' && conf.charAt(i+1) == '[')
                    {
                        html += tmp;
                        html += "<br>";
                        level += num;
                        tmp = "";
                        for(let j=0;j<level;j++)
                            html += "\xa0"
                    }

                    if(conf.charAt(i) == ']' && conf.charAt(i+1) == ',')
                    {
                        html += tmp;
                        tmp = "";
                        level -= num;
                    } else if(conf.charAt(i) == ']' && conf.charAt(i+1) == ']')
                    {
                        html += tmp;
                        tmp = "";
                        html += "<br>";
                        level -= num;
                        for(let j=0;j<level;j++)
                            html += "\xa0"
                    }
                }
                html += tmp;
                return html;
            }

            var conf = "[[667,3,[[99999999999,10900,[[99999999999,20000000,1000],[20000000,10000000,900],[10000000,5000000,800],[5000000,1000000,700]]],[10900,10600,[[99999999999,20000000,900],[20000000,10000000,800],[10000000,5000000,700],[5000000,1000000,600]]],[10600,10300,[[99999999999,20000000,800],[20000000,10000000,700],[10000000,5000000,600],[5000000,1000000,500]]],[10300,10000,[[99999999999,20000000,700],[20000000,10000000,600],[10000000,5000000,500],[5000000,1000000,400]]],[9000,7000,[[-99999999999,-20000000,-250],[-20000000,-10000000,-200],[-10000000,-5000000,-200],[-5000000,-1000000,-200]]],[7000,0,[[-99999999999,-20000000,-300],[-20000000,-10000000,-200],[-10000000,-5000000,-200],[-5000000,-1000000,-200]]]]],[2405,3,[[99999999999,10900,[[99999999999,20000000,1000],[20000000,10000000,900],[10000000,5000000,800],[5000000,1000000,700]]],[10900,10600,[[99999999999,20000000,900],[20000000,10000000,800],[10000000,5000000,700],[5000000,1000000,600]]],[10600,10300,[[99999999999,20000000,800],[20000000,10000000,700],[10000000,5000000,600],[5000000,1000000,500]]],[10300,10000,[[99999999999,20000000,700],[20000000,10000000,600],[10000000,5000000,500],[5000000,1000000,400]]],[9000,7000,[[-99999999999,-20000000,-250],[-20000000,-10000000,-200],[-10000000,-5000000,-200],[-5000000,-1000000,-200]]],[7000,0,[[-99999999999,-20000000,-300],[-20000000,-10000000,-200],[-10000000,-5000000,-200],[-5000000,-1000000,-200]]]]]]";
            document.write(formatArrString(conf));
        </script>
    </body>
</html>
```
#### 格式化效果

1. 使用 [bejson](https://www.bejson.com) 格式化出来的效果

```
[
    [667, 3, [
        [99999999999, 10900, [
            [99999999999, 20000000, 1000],
            [20000000, 10000000, 900],
            [10000000, 5000000, 800],
            [5000000, 1000000, 700]
        ]],
        [10900, 10600, [
            [99999999999, 20000000, 900],
            [20000000, 10000000, 800],
            [10000000, 5000000, 700],
            [5000000, 1000000, 600]
        ]],
        [10600, 10300, [
            [99999999999, 20000000, 800],
            [20000000, 10000000, 700],
            [10000000, 5000000, 600],
            [5000000, 1000000, 500]
        ]],
        [10300, 10000, [
            [99999999999, 20000000, 700],
            [20000000, 10000000, 600],
            [10000000, 5000000, 500],
            [5000000, 1000000, 400]
        ]],
        [9000, 7000, [
            [-99999999999, -20000000, -250],
            [-20000000, -10000000, -200],
            [-10000000, -5000000, -200],
            [-5000000, -1000000, -200]
        ]],
        [7000, 0, [
            [-99999999999, -20000000, -300],
            [-20000000, -10000000, -200],
            [-10000000, -5000000, -200],
            [-5000000, -1000000, -200]
        ]]
    ]],
    [2405, 3, [
        [99999999999, 10900, [
            [99999999999, 20000000, 1000],
            [20000000, 10000000, 900],
            [10000000, 5000000, 800],
            [5000000, 1000000, 700]
        ]],
        [10900, 10600, [
            [99999999999, 20000000, 900],
            [20000000, 10000000, 800],
            [10000000, 5000000, 700],
            [5000000, 1000000, 600]
        ]],
        [10600, 10300, [
            [99999999999, 20000000, 800],
            [20000000, 10000000, 700],
            [10000000, 5000000, 600],
            [5000000, 1000000, 500]
        ]],
        [10300, 10000, [
            [99999999999, 20000000, 700],
            [20000000, 10000000, 600],
            [10000000, 5000000, 500],
            [5000000, 1000000, 400]
        ]],
        [9000, 7000, [
            [-99999999999, -20000000, -250],
            [-20000000, -10000000, -200],
            [-10000000, -5000000, -200],
            [-5000000, -1000000, -200]
        ]],
        [7000, 0, [
            [-99999999999, -20000000, -300],
            [-20000000, -10000000, -200],
            [-10000000, -5000000, -200],
            [-5000000, -1000000, -200]
        ]]
    ]]
]
```
2.使用 formatArrString 函数格式化出来的效果
```
[
    [667,3,
        [
            [99999999999,10900,
                [
                    [99999999999,20000000,1000],
                    [20000000,10000000,900],
                    [10000000,5000000,800],
                    [5000000,1000000,700]
                ]
            ],
            [10900,10600,
                [
                    [99999999999,20000000,900],
                    [20000000,10000000,800],
                    [10000000,5000000,700],
                    [5000000,1000000,600]
                ]
            ],
            [10600,10300,
                [
                    [99999999999,20000000,800],
                    [20000000,10000000,700],
                    [10000000,5000000,600],
                    [5000000,1000000,500]
                ]
            ],
            [10300,10000,
                [
                    [99999999999,20000000,700],
                    [20000000,10000000,600],
                    [10000000,5000000,500],
                    [5000000,1000000,400]
                ]
            ],
            [9000,7000,
                [
                    [-99999999999,-20000000,-250],
                    [-20000000,-10000000,-200],
                    [-10000000,-5000000,-200],
                    [-5000000,-1000000,-200]
                ]
            ],
            [7000,0,
                [
                    [-99999999999,-20000000,-300],
                    [-20000000,-10000000,-200],
                    [-10000000,-5000000,-200],
                    [-5000000,-1000000,-200]
                ]
            ]
        ]
    ],
    [2405,3,
        [
            [99999999999,10900,
                [
                    [99999999999,20000000,1000],
                    [20000000,10000000,900],
                    [10000000,5000000,800],
                    [5000000,1000000,700]
                ]
            ],
            [10900,10600,
                [
                    [99999999999,20000000,900],
                    [20000000,10000000,800],
                    [10000000,5000000,700],
                    [5000000,1000000,600]
                ]
            ],
            [10600,10300,
                [
                    [99999999999,20000000,800],
                    [20000000,10000000,700],
                    [10000000,5000000,600],
                    [5000000,1000000,500]
                ]
            ],
            [10300,10000,
                [
                    [99999999999,20000000,700],
                    [20000000,10000000,600],
                    [10000000,5000000,500],
                    [5000000,1000000,400]
                ]
            ],
            [9000,7000,
                [
                    [-99999999999,-20000000,-250],
                    [-20000000,-10000000,-200],
                    [-10000000,-5000000,-200],
                    [-5000000,-1000000,-200]
                ]
            ],
            [7000,0,
                [
                    [-99999999999,-20000000,-300],
                    [-20000000,-10000000,-200],
                    [-10000000,-5000000,-200],
                    [-5000000,-1000000,-200]
                ]
            ]
        ]
    ]
]
```